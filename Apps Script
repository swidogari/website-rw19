<script>
  async function checkStatus(event) {
    event.preventDefault();
    const id = document.getElementById('idWarga').value.trim();
    const result = document.getElementById('statusResult');
    result.textContent = "Memeriksa data...";

    try {
      const res = await fetch(`https://script.google.com/macros/s/AKfycbxxxx/exec?id=${id}`);
      const data = await res.json();

      if (data.error) {
        result.textContent = "‚ùå ID tidak ditemukan.";
      } else {
        result.textContent = `‚úÖ ${data.nama} - Status: ${data.status} (Tanggal: ${data.tanggal || '-'})`;
      }
    } catch (err) {
      result.textContent = "‚ö†Ô∏è Terjadi kesalahan saat mengambil data.";
    }
  }
</script>




üìò Langkah di sisi Google Apps Script
Buat file Apps Script baru dan tempelkan kode berikut, lalu Deploy ‚Üí New Deployment ‚Üí Web App (akses: Anyone):

# Copy
function doGet(e) {
  const ss = SpreadsheetApp.openById("SPREADSHEET_ID"); // ganti ID spreadsheet
  const sheet = ss.getSheetByName("Pengumuman");
  const data = sheet.getDataRange().getValues().slice(1);
  const result = data.map(r => ({ judul: r[0], isi: r[1] }));
  return ContentService.createTextOutput(JSON.stringify(result))
    .setMimeType(ContentService.MimeType.JSON);
}

function doPost(e) {
  const ss = SpreadsheetApp.openById("SPREADSHEET_ID");
  const sheet = ss.getSheetByName("Pengumuman");
  const params = e.parameter;
  const action = params.action;

  if (action === "add") {
    sheet.appendRow([params.judul, params.isi, new Date()]);
    return jsonResponse("Pengumuman ditambahkan.");
  }

  if (action === "update") {
    const row = Number(params.index) + 2;
    sheet.getRange(row, 1, 1, 2).setValues([[params.judul, params.isi]]);
    return jsonResponse("Pengumuman diperbarui.");
  }

  if (action === "delete") {
    const row = Number(params.index) + 2;
    sheet.deleteRow(row);
    return jsonResponse("Pengumuman dihapus.");
  }

  return jsonResponse("Aksi tidak dikenal.");
}

function jsonResponse(msg) {
  return ContentService.createTextOutput(JSON.stringify({ message: msg }))
    .setMimeType(ContentService.MimeType.JSON);
}
